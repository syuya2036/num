# 数値解析課題　前半

4J-15 後藤柊矢

## 課題について

コードは全て私の[GitHub](https://github.com/syuya2036/num)に公開している。

## 1. 積分

### ソースコード 

[Integrate](../integrate/integrate.go)

### 精度

- 台形法
  
| N | 結果 | 誤差 |
| --- | --- | --- |
| 1000 | 20.001954 | 0.001954 | 
| 10000 | 20.000200 | 0.000200 | 
| 100000 | 20.000020 | 0.000020 | 
| 1000000 | 20.000002 | 0.000002 | 
| 10000000 | 20.000000 | 0.000000 |

- シンプソン法
  
| N | 結果 | 誤差 |
| --- | --- | --- |
| 1000 | 19.999964 | 0.000036 | 
| 10000 | 20.000000 | 0.000000 | 
| 100000 | 20.000000 | 0.000000 | 
| 1000000 | 20.000000 | 0.000000 | 
| 10000000 | 20.000000 | 0.000000 |

- モンテカルロ法

| N | 結果 | 誤差 |
| --- | --- | --- |
| 1000 | 19.488019 | 0.511981 | 
| 10000 | 20.435203 | 0.435203 | 
| 100000 | 19.975144 | 0.024856 | 
| 1000000 | 20.013372 | 0.013372 | 
| 10000000 | 19.999374 | 0.000626 |

### コメント
モンテカルロ法は長方形、台形法は台形、シンプソン法は2次関数で近似するため、この順番で精度が高くなったと考えられる。

## 2. 微分方程式

### ソースコード 

[DiffEQ](../integrate/diff.go)

### 精度

- オイラー法
  
| N | y |
| --- | --- |
| 1000 | 11.748625 | 
| 10000 | 11.777912 | 
| 100000 | 11.778092 | 
| 1000000 | 11.778083 | 

- ルンゲ・クッタ法

| N | y |
| --- | --- |
| 1000 | 11.778112 | 
| 10000 | 11.780868 | 
| 100000 | 11.778388 | 
| 1000000 | 11.778112 | 

### コメント

オイラー法の推定誤差は、定義から明らかにO(h)であるのに対し、ルンゲ・クッタ法はテイラー展開の厳密解と4次の項まで一致するため推定誤差はO(h**4)である。よって一般に、ルンゲ・クッタ法の方が誤差が小さくなると言える。 


## 3. モンテカルロ法

### ソースコード

[Montecarlo](../integrate/circle.go)

### 精度

| N | 結果 | 誤差 |
| --- | --- | --- |
| 1000 | 0.521000 | 0.002600 | 
| 10000 | 0.526900 | 0.003300 | 
| 100000 | 0.523460 | 0.000140 | 
| 1000000 | 0.522876 | 0.000724 | 
| 10000000 | 0.523616 | 0.000016 |